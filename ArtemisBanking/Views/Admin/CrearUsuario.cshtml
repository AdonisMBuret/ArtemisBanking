@model ArtemisBanking.Web.ViewModels.Usuario.CrearUsuarioViewModel

@{
    ViewData["Title"] = "Crear Usuario";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- ==================== CREAR USUARIO ==================== -->
<!-- Encabezado -->
<div class="row mb-4">
    <div class="col-12">
        <h2 class="text-primary-artemis mb-1">
            <i class="fas fa-user-plus me-2"></i>
            Crear Nuevo Usuario
        </h2>
        <p class="text-muted mb-0">
            <i class="fas fa-info-circle me-2"></i>
            Complete el formulario para registrar un nuevo usuario en el sistema
        </p>
        <hr style="border-color: var(--color-gray);">
    </div>
</div>

<!-- Formulario -->
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card-artemis">
            <div class="card-artemis-header">
                <i class="fas fa-clipboard-list me-2"></i>
                Datos del Usuario
            </div>
            <div class="card-artemis-body p-4">
                <form asp-action="CrearUsuario" method="post">
                    <!-- Validación general -->
                    <div asp-validation-summary="ModelOnly" class="alert alert-danger-artemis mb-4"></div>

                    <!-- ==================== INFORMACIÓN PERSONAL ==================== -->
                    <h5 class="text-secondary-artemis mb-3">
                        <i class="fas fa-id-card me-2"></i>
                        Información Personal
                    </h5>

                    <div class="row">
                        <!-- Nombre -->
                        <div class="col-md-6 mb-3">
                            <label asp-for="Nombre" class="form-label-artemis"></label>
                            <input asp-for="Nombre" class="form-control form-control-artemis" placeholder="Ingrese el nombre" />
                            <span asp-validation-for="Nombre" class="text-danger"></span>
                        </div>

                        <!-- Apellido -->
                        <div class="col-md-6 mb-3">
                            <label asp-for="Apellido" class="form-label-artemis"></label>
                            <input asp-for="Apellido" class="form-control form-control-artemis" placeholder="Ingrese el apellido" />
                            <span asp-validation-for="Apellido" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Cédula -->
                        <div class="col-md-6 mb-3">
                            <label asp-for="Cedula" class="form-label-artemis"></label>
                            <input asp-for="Cedula" class="form-control form-control-artemis" placeholder="000-0000000-0" />
                            <span asp-validation-for="Cedula" class="text-danger"></span>
                        </div>

                        <!-- Correo -->
                        <div class="col-md-6 mb-3">
                            <label asp-for="Correo" class="form-label-artemis"></label>
                            <input asp-for="Correo" type="email" class="form-control form-control-artemis" placeholder="usuario@ejemplo.com" />
                            <span asp-validation-for="Correo" class="text-danger"></span>
                        </div>
                    </div>

                    <hr class="my-4" style="border-color: var(--color-gray);">

                    <!-- ==================== CREDENCIALES ==================== -->
                    <h5 class="text-secondary-artemis mb-3">
                        <i class="fas fa-key me-2"></i>
                        Credenciales de Acceso
                    </h5>

                    <div class="row">
                        <!-- Nombre de Usuario -->
                        <div class="col-md-6 mb-3">
                            <label asp-for="NombreUsuario" class="form-label-artemis"></label>
                            <input asp-for="NombreUsuario" class="form-control form-control-artemis" placeholder="usuario123" />
                            <span asp-validation-for="NombreUsuario" class="text-danger"></span>
                            <small class="text-muted">
                                <i class="fas fa-info-circle me-1"></i>
                                Sin espacios ni caracteres especiales
                            </small>
                        </div>

                        <!-- Tipo de Usuario -->
                        <div class="col-md-6 mb-3">
                            <label asp-for="TipoUsuario" class="form-label-artemis"></label>
                            <select asp-for="TipoUsuario" class="form-control form-control-artemis" id="tipoUsuarioSelect">
                                <option value="">-- Seleccione un rol --</option>
                                <option value="Administrador">
                                    Administrador
                                </option>
                                <option value="Cajero">
                                    Cajero
                                </option>
                                <option value="Cliente">
                                    Cliente
                                </option>
                            </select>
                            <span asp-validation-for="TipoUsuario" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Contraseña -->
                        <div class="col-md-6 mb-3">
                            <label asp-for="Contrasena" class="form-label-artemis"></label>
                            <input asp-for="Contrasena" type="password" class="form-control form-control-artemis" />
                            <span asp-validation-for="Contrasena" class="text-danger"></span>
                            <small class="text-muted d-block mt-1">
                                <i class="fas fa-shield-alt me-1"></i>
                                Mínimo 8 caracteres, mayúsculas, minúsculas, números y símbolos
                            </small>
                        </div>

                        <!-- Confirmar Contraseña -->
                        <div class="col-md-6 mb-3">
                            <label asp-for="ConfirmarContrasena" class="form-label-artemis"></label>
                            <input asp-for="ConfirmarContrasena" type="password" class="form-control form-control-artemis" />
                            <span asp-validation-for="ConfirmarContrasena" class="text-danger"></span>
                        </div>
                    </div>

                    <!-- ==================== MONTO INICIAL (SOLO CLIENTES) ==================== -->
                    <div id="montoInicialDiv" style="display: none;">
                        <hr class="my-4" style="border-color: var(--color-gray);">

                        <h5 class="text-secondary-artemis mb-3">
                            <i class="fas fa-wallet me-2"></i>
                            Información Financiera
                        </h5>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="MontoInicial" class="form-label-artemis"></label>
                                <div class="input-group">
                                    <span class="input-group-text" style="background-color: var(--color-light); border-color: var(--color-gray);">
                                        RD$
                                    </span>
                                    <input asp-for="MontoInicial"
                                           type="number"
                                           step="0.01"
                                           class="form-control form-control-artemis"
                                           placeholder="0.00" />
                                </div>
                                <span asp-validation-for="MontoInicial" class="text-danger"></span>
                                <small class="text-muted d-block mt-1">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Balance inicial de la cuenta de ahorro principal
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- ==================== BOTONES ==================== -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="d-flex gap-2 justify-content-end">
                                <!-- Botón Cancelar -->
                                <a asp-action="Usuarios" class="btn btn-outline-artemis">
                                    <i class="fas fa-times me-2"></i>
                                    Cancelar
                                </a>

                                <!-- Botón Guardar -->
                                <button type="submit" class="btn btn-primary-artemis">
                                    <i class="fas fa-save me-2"></i>
                                    Crear Usuario
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Información adicional -->
        <div class="alert alert-warning-artemis mt-3">
            <i class="fas fa-envelope me-2"></i>
            <strong>Importante:</strong>
            El usuario recibirá un correo electrónico con un token para activar su cuenta.
        </div>
    </div>
</div>

<!-- ==================== SCRIPTS ==================== -->
@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        // Mostrar/ocultar campo de monto inicial según el tipo de usuario
        document.addEventListener('DOMContentLoaded', function() {
            const tipoUsuarioSelect = document.getElementById('tipoUsuarioSelect');
            const montoInicialDiv = document.getElementById('montoInicialDiv');

            if (tipoUsuarioSelect && montoInicialDiv) {
                // Función para mostrar/ocultar
                function toggleMontoInicial() {
                    if (tipoUsuarioSelect.value === 'Cliente') {
                        montoInicialDiv.style.display = 'block';
                    } else {
                        montoInicialDiv.style.display = 'none';
                    }
                }

                // Escuchar cambios en el select
                tipoUsuarioSelect.addEventListener('change', toggleMontoInicial);

                // Ejecutar al cargar
                toggleMontoInicial();
            }
        });
    </script>
}